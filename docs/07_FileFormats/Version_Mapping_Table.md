---
date: 2026-02-26
title: Macro Version and CSV Schema Version Mapping
version: Macro_v1.0.0
---

# CSVバージョンとMacroバージョンの正式対応表（Macro_v1.0.0）

## 1. 目的

本ドキュメントは、Macroのバージョン（Macro_vX.Y.Z）と、CSVスキーマ（列定義）のバージョンを
**正式に対応付ける**ためのルールと対応表を定義する。

-   Macroバージョン：アプリの機能実装・動作仕様のバージョン
-   CSVスキーマバージョン：CSV列（ヘッダ）と各列の意味・制約のバージョン

> 重要：Macroのパッチ修正（Z）は、CSVスキーマを変えないことを原則とする。

------------------------------------------------------------------------

## 2. 用語

-   **Macroバージョン**：`Macro_vX.Y.Z`
    -   X：機能追加（互換性破壊を含む大きな変更）
    -   Y：修正（機能の不具合修正・軽微な改善）
    -   Z：パッチ（表示文言や微調整などの小さな修正）
-   **CSVスキーマバージョン**：`CSV_vA.B`
    -   A：列追加/削除/意味変更など、Import/Exportの実装に影響する変更（原則：メジャー）
    -   B：仕様書の明文化、バリデーション文言の補足など、実装互換に影響しない変更（マイナー）

------------------------------------------------------------------------

## 3. ルール（正式）

### 3.1 Macroバージョン → CSVスキーマの変化判定

  -----------------------------------------------------------------------------------------------------
  変更内容                                                      Macro側の増分       CSVスキーマ側の増分
  ------------------------------------------------- ------------------------- -------------------------
  CSV列の追加                                                     X+1（推奨）                       A+1

  CSV列の削除                                                     X+1（必須）                       A+1

  CSV列の意味変更（同じ列名で意味が変わる）                       X+1（必須）                       A+1

  CSV列の並び順変更（ヘッダ順固定方針の変更）                     X+1（必須）                       A+1

  列の名称変更（rename）                                          X+1（必須）                       A+1

  Import/Exportの仕様書補足のみ（実装互換は維持）              Y+1 または Z+1                       B+1

  Macro機能の不具合修正のみ（CSVは不変）                       Y+1 または Z+1                  変更なし

  UI改善のみ（保存形式に影響なし）                             Y+1 または Z+1                  変更なし
  -----------------------------------------------------------------------------------------------------

> 原則：CSVスキーマに影響する変更は **Macroのメジャー（X）を上げる**。

------------------------------------------------------------------------

## 4. 互換性ポリシー（正式）

### 4.1 Import互換性

-   **CSV_vA.B は同一A内で後方互換を維持**する方針とする。
    -   例：`CSV_v1.0` を読める Import
        は、`CSV_v1.1`（列意味不変・補足のみ）も読める。
-   **Aが異なる場合（CSV_v2.x など）は互換保証しない**
    -   原則：Importはエラー（または変換ツールを別途提供）

### 4.2 Export互換性

-   Exportは **常にアプリがサポートする最新CSVスキーマ**で出力する。
-   旧スキーマへのExport（ダウングレード）は v1.0.0
    では対象外（将来検討）。

------------------------------------------------------------------------

## 5. CSVスキーマ識別方法（v1.0.0方式）

v1.0.0 では以下のいずれかでスキーマを識別する。

### 方式A（推奨）：ファイル名で識別

-   例：`MyMacro_CSV_v1.0.csv`

### 方式B：ヘッダ一致で識別

-   ヘッダの完全一致を行い、既知のヘッダであれば受け付ける。
-   未知の列がある場合は Importエラー（推奨）

> v1.0.0
> は「方式B（ヘッダ一致）」で実装が簡単。将来、方式A＋メタ行（Version列）追加を検討可能。

------------------------------------------------------------------------

# 6. 正式対応表（Macro_v1.0.0時点）

## 6.1 対応表

  -------------------------------------------------------------------------------------------------------
  Macroバージョン   対応CSVスキーマ   Import         Export         備考
  ----------------- ----------------- -------------- -------------- -------------------------------------
  Macro_v1.0.0      CSV_v1.0          対応           対応           初版。ヘッダ固定。`Color`列を含む。

  -------------------------------------------------------------------------------------------------------

## 6.2 CSV_v1.0 の対象仕様書

-   `docs/06_Persistence/CSV_Import_Spec_v1.0.0.md`
-   `docs/06_Persistence/CSV_Export_Spec_v1.0.0.md`

------------------------------------------------------------------------

# 7. 将来の例（運用サンプル）

## 7.1 列追加（例：`WindowTitle` 列を追加）

-   Macro: `Macro_v2.0.0`
-   CSV : `CSV_v2.0`
-   旧CSV（CSV_v1.x）は Import互換対象外 →
    エラー（または変換を別途提供）

## 7.2 仕様書補足のみ

-   Macro: `Macro_v1.0.1`（または `Macro_v1.1.0`）
-   CSV : `CSV_v1.1`（またはCSVは不変でBだけ上げる）

------------------------------------------------------------------------

# 8. 推奨配置場所

    docs/06_Persistence/Version_Mapping_Spec.md

------------------------------------------------------------------------

以上
